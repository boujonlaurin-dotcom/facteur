# Story 7.3: MVP Perspectives - Frontend UI

## Status
Done

## Story
**As a** utilisateur,
**I want** accéder aux perspectives alternatives depuis l'écran article,
**so that** je puisse facilement consulter d'autres points de vue.

## Acceptance Criteria
1. ✅ Bouton ⚖️ visible dans le header de l'ArticleViewerModal (articles uniquement).
2. ✅ Bottom sheet avec liste des perspectives et leurs biais.
3. ✅ Bias bar visuelle (gauche ↔ droite).
4. [MOD] Saturation dynamique (12% / 55% / 80% / 100%) + bordure noire subtile (0.8px) + espaces inter-segments de 2px.
5. ✅ Tap sur perspective ouvre l'article externe.
6. ✅ Loading state pendant la recherche.
7. **Pop-up Explicatif FQS** : Au tap sur l'icône de fiabilité d'une source, une modale explique le score FQS (Indépendance etc.). [New]

## Tasks / Subtasks
- [x] FeedRepository (AC: 1)
  - [x] Add `getPerspectives(contentId)` method
  - [x] Create `PerspectivesResponse` and `PerspectiveData` models
- [x] PerspectivesBottomSheet Widget (AC: 2, 3, 4)
  - [x] Create `perspectives_bottom_sheet.dart`
  - [x] Implement `BiasBar` visualization
  - [x] Implement `PerspectiveCard` with external link
- [x] ArticleViewerModal Integration (AC: 1, 5)
  - [x] Add ⚖️ IconButton (conditional: articles only)
  - [x] Implement `_showPerspectives()` with loading state
  - [x] Fix content type comparison (enum vs string)

## Dev Notes
- Bouton perspectives visible uniquement pour `ContentType.article`
- Couleurs par biais:
  - left: rouge (#E53E3E)
  - center-left: orange (#ED8936)
  - center: violet (#805AD5)
  - center-right: bleu clair (#4299E1)
  - right: bleu foncé (#3182CE)
  - far-right: bleu très foncé

### Source Tree
```
apps/mobile/lib/features/feed/widgets/perspectives_bottom_sheet.dart  [NEW]
apps/mobile/lib/features/feed/widgets/article_viewer_modal.dart       [MODIFIED]
apps/mobile/lib/features/feed/repositories/feed_repository.dart       [MODIFIED]
```

## Testing
- [x] Widget: BiasBar displays correctly
- [x] Widget: PerspectiveCard opens external URL
- [x] Integration: Bottom sheet loads perspectives from API
- [x] UX: Loading state shows during API call
- [x] Flutter analyze: 0 errors

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 12/01/2026 | 1.0 | Création initiale | Dev Agent |
| 12/01/2026 | 1.1 | Fix content type comparison (enum) | Dev Agent |
| 12/01/2026 | 1.2 | Header bias/reliability tags & Bottom CTA | Dev Agent |

## Dev Agent Record

### Agent Model Used
Antigravity (Google Deepmind)

### Completion Notes List
- Created PerspectivesBottomSheet with bias bar and perspective cards
- Integrated into ArticleViewerModal header with conditional visibility
- Fixed bug: contentType comparison was string vs enum
- **UI UX Enhancement**: Added political bias tags and reliability icons in Article header
- **UI UX Enhancement**: Replaced header icon with a prominent bottom persistent CTA "Comparer les perspectives"
- Centralized bias colors/labels in `Source` model for consistency

### File List
- `apps/mobile/lib/features/feed/widgets/perspectives_bottom_sheet.dart` - Modified
- `apps/mobile/lib/features/feed/widgets/article_viewer_modal.dart` - Modified
- `apps/mobile/lib/features/sources/models/source_model.dart` - Modified
- `apps/mobile/lib/features/feed/repositories/feed_repository.dart` - Modified
