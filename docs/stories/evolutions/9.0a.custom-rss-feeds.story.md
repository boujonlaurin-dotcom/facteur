# Story 9.0a: Ajout de sources personnalis√©es (RSS/YouTube)

**Epic:** 9 - Open Sources
**Classification:** EVOLUTION

---

## Description

**En tant que** "Curious Explorer" (Utilisateur),
**Je veux** pouvoir ajouter n'importe quel flux RSS, cha√Æne YouTube ou Podcast via son URL,
**afin de** centraliser toute ma veille d'information dans Facteur, m√™me pour des sources de niche non list√©es dans le catalogue officiel.

---

## Contexte

Actuellement, Facteur ne propose qu'un catalogue "Curated" de sources valid√©es. Pour devenir l'application de lecture ultime, l'utilisateur doit pouvoir s'approprier son feed en ajoutant ses propres sources ("Open Web").

---

## Crit√®res d'acceptation

### 1. Ajout de Source & "Smart Detect" (Compromis V0)
- ‚úÖ **URL Directe** : L'utilisateur peut coller une URL de flux (RSS/Atom/Youtube/Podcast).
- ‚úÖ **Auto-D√©couverte (Smart Detect)** : Si l'utilisateur colle une URL de site classique (ex: `https://www.lemonde.fr`), le syst√®me tente de trouver automatiquement le lien RSS dans le HTML (`<link rel="alternate" type="application/rss+xml">`).
- ‚úÖ **Pr√©visualisation** : Afficher une card avec Nom + Logo + 3 derniers articles pour confirmer que c'est bien ce que l'utilisateur voulait.

### 2. Gestion des Erreurs (P√©dagogie)
- ‚úÖ Si l'URL renvoie vers une page sans flux : "Nous n'avons trouv√© aucun fil d'actualit√© sur cette page. Essayez de chercher un lien 'RSS' ou 'Flux' sur le site."
- ‚úÖ Si l'URL est prot√©g√©e/priv√©e (401/403) : "Cette source semble priv√©e ou prot√©g√©e par un mot de passe. Facteur ne supporte que les sources publiques."
- ‚úÖ Si le flux est cass√©/invalide : "Le format de cette source n'est pas reconnu par Facteur."

### 3. Gestion des Doublons
- ‚úÖ Le syst√®me v√©rifie si la source existe d√©j√† (par `feed_url`).
- ‚úÖ Si elle existe, on r√©utilise l'objet `Source` existant.
- ‚úÖ L'utilisateur ne peut pas ajouter deux fois la m√™me source √† son compte.

### 4. Limitations V1
- üî¥ Pas de support des flux authentifi√©s (password/token).
- üî¥ Pas de moteur de recherche interne (Google Search est n√©cessaire si l'Auto-D√©couverte √©choue).

---

## Impl√©mentation technique

- **Backend** :
    - Utiliser `SourceService.detect_source(url)` pour l'analyse.
    - Endpoint `POST /sources/custom` pour l'enregistrement.
    - Stockage : Table `user_sources` avec `is_custom=true`.
- **Frontend** :
    - √âcran `add_source_screen.dart` (existant √† c√¢bler).
    - Widget `SourcePreviewCard` √† cr√©er.

---

## V√©rification
- [ ] Test manuel : Ajouter un flux RSS valide (ex: The Verge).
- [ ] Test manuel : Ajouter une cha√Æne YouTube.
- [ ] Test manuel : Tenter une URL invalide.
- [ ] V√©rification DB : Une source ajout√©e par 2 users n'a qu'une ligne dans `sources`.
