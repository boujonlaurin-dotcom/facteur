#!/bin/bash
# =============================================================================
# Script de v√©rification : Onboarding Th√®mes First (Story 2.7)
# =============================================================================
#
# OBJECTIF : V√©rifier que l'ordre de Section 3 est invers√© et que la
#            pr√©-s√©lection des sources fonctionne correctement.
#
# PR√âREQUIS :
#   - App mobile compil√©e et lanc√©e
#   - Nouveau compte utilisateur (ou reset onboarding via Settings)
#
# =============================================================================

echo "=================================================="
echo "  VERIFICATION : Onboarding Themes First (2.7)"
echo "=================================================="
echo ""

echo "=== TEST 1: Ordre des questions Section 3 ==="
echo ""
echo "  1. Lancer l'app et cr√©er un nouveau compte"
echo "  2. Compl√©ter Sections 1 et 2 normalement"
echo "  3. Arriver √† Section 3"
echo ""
echo "  ‚úÖ ATTENDU : La premi√®re question de Section 3 est THEMES (Q9)"
echo "              - Titre: 'Quels sont vos centres d'int√©r√™t ?'"
echo "              - Chips de th√®mes avec sous-th√®mes expansibles"
echo ""
echo "  4. S√©lectionner 2-3 th√®mes (ex: Tech, Science, International)"
echo "  5. Appuyer sur 'Continuer'"
echo ""
echo "  ‚úÖ ATTENDU : L'√©cran suivant est SOURCES (Q10)"
echo "              - Titre: 'Construisons votre front de sources fiables.'"
echo ""
read -p "Appuyez sur Entr√©e pour continuer..."

echo ""
echo "=== TEST 2: Pr√©-s√©lection des sources ==="
echo ""
echo "  Sur l'√©cran Sources (Q10) :"
echo ""
echo "  ‚úÖ ATTENDU 1 : Message informatif visible en haut"
echo "                 'üí° Pr√©-s√©lection bas√©e sur vos th√®mes'"
echo ""
echo "  ‚úÖ ATTENDU 2 : Plusieurs sources sont PR√â-COCH√âES"
echo "                 (chips avec bordure terracotta)"
echo ""
echo "  ‚úÖ ATTENDU 3 : Les sources pr√©-s√©lectionn√©es correspondent aux th√®mes"
echo "                 Ex: Tech ‚Üí ScienceEtonnante, Epsiloon, etc."
echo "                 Ex: International ‚Üí Le Dessous des Cartes, etc."
echo ""
read -p "Appuyez sur Entr√©e pour continuer..."

echo ""
echo "=== TEST 3: Modification de la pr√©-s√©lection ==="
echo ""
echo "  1. D√©cocher une source pr√©-s√©lectionn√©e (tap sur une chip coch√©e)"
echo "  2. Cocher une nouvelle source non pr√©-s√©lectionn√©e"
echo ""
echo "  ‚úÖ ATTENDU : Les modifications sont prises en compte"
echo "              Le bouton 'Continuer (X s√©lectionn√©s)' se met √† jour"
echo ""
echo "  3. Appuyer sur 'Continuer'"
echo "  4. Sur l'√©cran Finalize, appuyer sur 'Cr√©er mon flux'"
echo "  5. Attendre l'animation de conclusion"
echo ""
echo "  ‚úÖ ATTENDU : Arriv√©e sur le Feed personnalis√©"
echo "              Les sources s√©lectionn√©es sont utilis√©es"
echo ""
read -p "Appuyez sur Entr√©e pour continuer..."

echo ""
echo "=== TEST 4: Navigation retour (Back) ==="
echo ""
echo "  1. Refaire l'onboarding (via Settings > Refaire l'onboarding)"
echo "  2. Arriver √† l'√©cran Sources (Q10)"
echo "  3. Appuyer sur le bouton Retour (fl√®che en haut √† gauche)"
echo ""
echo "  ‚úÖ ATTENDU 1 : Retour sur l'√©cran Th√®mes (Q9)"
echo "  ‚úÖ ATTENDU 2 : Les th√®mes pr√©c√©demment s√©lectionn√©s sont TOUJOURS coch√©s"
echo ""
echo "  4. Revenir sur l'√©cran Sources"
echo ""
echo "  ‚úÖ ATTENDU 3 : La pr√©-s√©lection est conserv√©e"
echo ""
read -p "Appuyez sur Entr√©e pour continuer..."

echo ""
echo "=== TEST 5: Sauvegarde backend ==="
echo ""
echo "  1. Compl√©ter l'onboarding avec des th√®mes et sources sp√©cifiques"
echo "  2. Ouvrir les DevTools backend ou Supabase Dashboard"
echo "  3. V√©rifier la table 'user_interests'"
echo ""
echo "  ‚úÖ ATTENDU : Les th√®mes s√©lectionn√©s sont enregistr√©s"
echo ""
echo "  4. V√©rifier la table 'user_sources' (ou preferred_sources dans profil)"
echo ""
echo "  ‚úÖ ATTENDU : Les sources s√©lectionn√©es (finales) sont enregistr√©es"
echo ""

echo ""
echo "=================================================="
echo "  R√âSUM√â DE LA V√âRIFICATION"
echo "=================================================="
echo ""
echo "  Si tous les tests passent :"
echo "  ‚úÖ Story 2.7 impl√©ment√©e correctement"
echo ""
echo "  Si un test √©choue :"
echo "  ‚ùå Documenter le probl√®me dans docs/bugs/"
echo "  ‚ùå Cr√©er une issue avec les d√©tails"
echo ""
echo "=================================================="
